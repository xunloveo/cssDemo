<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>把ajax获取的数据改位树状结构</title>
</head>

<body>
  <script>
    var arr = [{
      id: 1,
      name: "一级标题",
      pid: 0
    }, {
      id: 2,
      name: "二级标题",
      pid: 0
    }, {
      id: 3,
      name: "2.1级标题",
      pid: 2
    }, {
      id: 4,
      name: "2.2级标题",
      pid: 2
    }, {
      id: 'objk',
      name: "1.1级标题",
      pid: 1
    }, {
      id: 6,
      name: "1.2级标题",
      pid: 1
    }, {
      id: 7,
      name: "1.21级标题",
      pid: 6
    }, {
      id: 8,
      name: "三级标题",
      pid: 0
    }, {
      id: 9,
      name: "1.22级标题",
      pid: 6
    }, {
      id: 10,
      name: "1.221级标题",
      pid: 9
    }, {
      id: 11,
      name: "1.2211级标题",
      pid: 10
    }, {
      id: 12,
      name: "1.2212级标题",
      pid: 10
    }];

    function proJSON(oldArr, pid) {
      var newArr = [];
      var self = this;
      oldArr.map(function (item) {
        if (item.pid == pid) {
          var obj = {
            id: item.id,
            value: item.name
          }
          var childs = self.proJSON(oldArr, item.id);
          if (childs.length > 0) {
            obj.childs = childs
          }
          newArr.push(obj)
        }
      })
      return newArr;
    };

    var testdata = proJSON(arr, 0);
    console.log(testdata);
  </script>
</body>

</html>